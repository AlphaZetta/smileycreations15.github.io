<!DOCTYPE html><html><head><title>Call a macro with parameters : Python win32com API</title></head><link href='style.css' rel='stylesheet' ><link rel='stylesheet' href='https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css'><body><h2><a href='//stackoverflow.com/a/54814719'>Call a macro with parameters : Python win32com API</a></h2><p class='feedback'></p><br /><pre style='border:1px solid black;border-radius:5px'><code><p>I'm trying to run Macro from PERSONAL.XLSB on some excel files and I get the error saying "The macro may not be available in this workbook or all macros may be disabled" even though I have enabled it in Trust centre and use them regularly.</p>

<p>Here's my code (Python 3):</p>

<pre><code>import win32com.client as win32
excel = win32.DispatchEx('Excel.Application')
wb = excel.Workbooks.Open(r'\...\path\to\my\excel\file.xlsx', ReadOnly=0)
excel.Application.Run(r'C:\Users\vjovanovic\AppData\Roaming\Microsoft\Excel\XLSTART\PERSONAL.XLSB!AddToMENAMacro')
excel.Workbooks.Close()
excel.Quit()
</code></pre>

<p>Does anyone know what am I missing?</p>

<p>Thanks!</p>
</code></pre><p>Posted by <a href='https://stackoverflow.com/users/9936337'>Veljko Jovanovic</a> (1) at 2019-02-21T19:26:10Z</p><p>Caught for</p>Contains Blacklisted Word - Does anyone know<br/>Contains ?<br/>Low Length<br/>Contains Salutation - Thanks<br/>Contains Whitelisted Word - this<br/>IntelliBL - -2.0<br/>Low Rep<br/></body></html>
